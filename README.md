# MQTT客户端演示程序

这是一个基于.NET 6.0和Windows Forms开发的MQTT客户端上位机应用程序，使用MQTTnet库实现MQTT协议功能。

## 功能特性

- **连接管理**：支持连接/断开MQTT代理服务器
- **认证支持**：可配置用户名和密码
- **发布消息**：支持发布消息到指定主题，可设置QoS级别和保留标志
- **订阅主题**：支持订阅/取消订阅主题，可查看已订阅的主题列表
- **消息接收**：实时显示接收到的消息
- **遗嘱消息**：支持配置MQTT遗嘱消息
- **日志记录**：内置日志功能，记录连接状态和消息收发情况
- **自动重连**：支持连接断开后的自动重连功能

## 技术栈

- **开发环境**：Visual Studio 2022
- **框架**：.NET 6.0
- **UI框架**：Windows Forms
- **MQTT库**：MQTTnet 4.3.2.1055
- **日志库**：Serilog 3.0.1

## 使用方法

1. 克隆或下载项目源代码
2. 使用Visual Studio 2022打开解决方案
3. 还原NuGet包：`dotnet restore`
4. 构建项目：`dotnet build`
5. 运行应用程序

## 连接设置

1. 在"连接设置"标签页中，填写MQTT代理服务器地址和端口
2. 可选：设置客户端ID、用户名和密码
3. 可选：配置遗嘱消息
4. 点击"连接"按钮连接到MQTT代理服务器

## 发布消息

1. 切换到"消息收发"标签页
2. 在"发布消息"区域，输入主题和消息内容
3. 选择QoS级别（0-最多一次，1-至少一次，2-仅一次）
4. 可选：勾选"保留消息"使消息成为保留消息
5. 点击"发布"按钮发送消息

## 订阅主题

1. 在"订阅主题"区域，输入要订阅的主题
2. 选择QoS级别
3. 点击"订阅"按钮订阅主题
4. 已订阅的主题将显示在列表中
5. 选择一个主题并点击"取消订阅"按钮可取消订阅

## 查看消息

- 收到的消息将实时显示在"收到的消息"列表中
- 消息包括时间戳、主题和消息内容

## 查看日志

- 切换到"日志"标签页可查看详细的系统日志
- 日志文件保存在应用程序目录下的"logs"文件夹中

## 默认设置

- **默认代理服务器**：test.mosquitto.org
- **默认端口**：1883
- **默认客户端ID**：自动生成的唯一ID
- **默认发布主题**：mqtt_demo/test
- **默认订阅主题**：mqtt_demo/#

## 注意事项

- 使用前请确保MQTT代理服务器可达
- 如需使用SSL/TLS连接，请修改代码中的连接选项
- 大规模使用时建议适当调整日志级别
- 消息列表限制为1000条，超出后会自动删除最旧的消息

## 许可证

[MIT License](LICENSE)